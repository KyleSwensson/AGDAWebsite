//TODO: fix doors,separate differences between mobile and desktop input into seperate file so the main js file will work for both and you dont need 2 huge js files
var playerYVelocity = 0;
var leftArrPressed = false;
var rightArrPressed = false;
var canJump = false;

var barUrl = "barSite.html";
var helpUrl = "helpSite.html";
var mailUrl = "mailSite.html";
var artUrl = "artSite.html";


$(document).ready(function() {
	setInterval(updateFunc, 50);
});



function updateFunc() {
	var player = $("#player");
	var ground = $("#ground");
	player.css({
		top: "+=" + playerYVelocity.toString()
	});
	if (playerYVelocity < 10) {
		playerYVelocity += 1;
	}
	if (player.position().top + player.height() > ground.position().top) {
		canJump = true;
		player.css({
			top: ground.position().top - player.height()
		});
	}
	if (leftArrPressed && !rightArrPressed) {
		if (ground.position().left >= 0 || player.position().left > ($("html").width() * .45)) {
			player.css({
				left: "-=20"
			});
		} else { 
			$(".nonPlayer").css({
				left: "+=20"
			});
		}
	} else if (rightArrPressed && !leftArrPressed) {
		if (ground.position().left + ground.width() <= $("html").width() || player.position().left < ($("html").width() * .45)) {
			player.css({
				left: "+=20"
			});
		} else {
			$(".nonPlayer").css({
				left: "-=20"
			});
		}
	}
}


$(document).keypress(function(e) {
	var player = $("#player");	
	console.log(e.which);
	
    if (e.which == 13) {
//	   console.log("enter");
	   $(".door").each(function(index) {
		   //checks if middle of player is in between left and right edge of door
		   console.log("left: " + $(this).offset().left + " : width" + $(this).width() + " playerMid: " + (player.offset().left + player.width()));
		   if ($(this).offset().left < player.offset().left + (player.width() / 2) && $(this).offset().left + $(this).width() > player.offset().left + (player.width() / 2)) {

			   if ($(this).attr('id') == "barDoor") { 
			   	location = barUrl;
			   } else if ($(this).attr('id') == "helpDoor") {
				location = helpUrl;
			   }  else if ($(this).attr('id') == "mailDoor") {
				location = artUrl;
			   }  else if ($(this).attr('id') == "artDoor") {
				location = artUrl;
			   }
		    }
	   });
	  
    } else if (e.which == 32) {
	   if (canJump) {
	   	playerYVelocity = -10;
		canJump = false;
	   }
    } 
});



$(document).keydown(function(e) {
//	console.log(e.which);
	if (e.which == 39) {
		rightArrPressed = true;
	} else if (e.which == 37) {
		leftArrPressed = true;
	}
});
$(document).keyup(function(e) {
	if (e.which == 39) {
		rightArrPressed = false;
	} else if (e.which == 37) {
		leftArrPressed = false;
	}
});
